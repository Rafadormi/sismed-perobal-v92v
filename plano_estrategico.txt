
# PLANO ESTRATÉGICO - SISTEMA DE RECEITAS MÉDICAS PEROBAL
# Versão: 2.0 - Atualizado em 15/08/2025

## 1. VISÃO GERAL DO SISTEMA

### 1.1 Objetivo
Sistema web integrado para cadastro de pacientes, medicamentos e emissão de receitas médicas digitais para a Prefeitura Municipal de Perobal - PR.

### 1.2 Tecnologias Utilizadas
- **Frontend**: React 18, TypeScript, Tailwind CSS
- **Backend**: Python Flask com SQLite
- **PDF**: jsPDF para geração de receitas
- **UI**: shadcn/ui components

### 1.3 Funcionalidades Principais
- ✅ Cadastro e gestão de pacientes
- ✅ Cadastro e gestão de medicamentos (comum e controlado)
- ✅ Emissão de receitas médicas com logo oficial
- ✅ Múltiplas receitas por data (sempre visível)
- ✅ Posologia opcional para medicamentos
- ✅ Geração e impressão de receitas em PDF
- ✅ Interface responsiva e moderna

## 2. ESPECIFICAÇÕES TÉCNICAS IMPLEMENTADAS

### 2.1 Cabeçalho Oficial das Receitas
- **Logo**: Utiliza logo oficial de Perobal (/lovable-uploads/691ec7a3-d30a-49df-b439-78a738b3aac6.png)
- **Informações Institucionais**:
  - Prefeitura Municipal de Perobal
  - Secretaria Municipal de Saúde
  - CNPJ: 76.460.526/0001-16
  - Endereço: Rua Jaracatiá, 1060 - CEP 87538-000 - Perobal - PR
  - Telefax: (44) 3625-1225
- **Versão Tela**: Logo maior com centralização
- **Versão Impressão**: Logo menor com layout horizontal otimizado

### 2.2 Sistema de Múltiplas Receitas
- **Interface**: Sempre expandida (removido toggle)
- **Funcionalidades**:
  - Seleção de múltiplas datas por checkbox
  - Adição/remoção dinâmica de datas
  - Contador de receitas selecionadas
  - Instruções de uso visíveis
- **Casos de Uso**:
  - Tratamentos contínuos
  - Medicamentos controlados
  - Agendamento de receitas futuras

### 2.3 Medicamentos com Posologia Opcional
- **Campo Posologia**: Agora opcional
- **Comportamento**:
  - Se vazio: automaticamente preenchido com "Conforme orientação médica"
  - Se preenchido: utiliza texto do usuário
- **Interface**: Indicação visual clara de campo opcional
- **Validação**: Apenas medicamento é obrigatório

### 2.4 Estrutura de Dados

#### Paciente
```typescript
interface Patient {
  id: number;
  nome: string;     // Obrigatório
  cpf: string;      // Opcional
  dataNascimento: string; // Opcional
}
```

#### Medicamento
```typescript
interface Medicine {
  id: number;
  nome: string;         // Denominação genérica
  dosagem: string;      // Concentração
  apresentacao: string; // Forma farmacêutica
}
```

#### Receita
```typescript
interface Prescription {
  id: number;
  pacienteId: number;
  data: string;
  dataVencimento?: string;
  medicamentos: PrescriptionMedicine[];
  observacoes: string;
}

interface PrescriptionMedicine {
  medicamentoId: number;
  posologia: string; // Agora pode ser padrão se vazio
}
```

## 3. FLUXO DE TRABALHO

### 3.1 Emissão de Receita
1. **Seleção do Paciente**: Busca por nome/CPF
2. **Configuração de Datas**: Interface sempre visível com múltiplas opções
3. **Seleção de Medicamentos**: Busca e seleção com posologia opcional
4. **Observações**: Campo livre para anotações médicas
5. **Geração**: Cria receitas para todas as datas selecionadas
6. **Impressão**: PDF com cabeçalho oficial completo

### 3.2 Validações Implementadas
- Paciente obrigatório para criar receita
- Pelo menos um medicamento obrigatório
- Pelo menos uma data habilitada
- Medicamento obrigatório, posologia opcional

## 4. INTERFACE DO USUÁRIO

### 4.1 Layout Responsivo
- **Desktop**: Tabs horizontais com navegação fluida
- **Mobile**: Interface adaptada para telas menores
- **Impressão**: Layout otimizado para A4

### 4.2 Componentes Principais
- `PrescriptionsTabs`: Navegação principal
- `PrescriptionHeader`: Cabeçalho com logo oficial
- `PrescriptionDateSelector`: Seletor sempre visível
- `MedicineSelector`: Seleção com posologia opcional
- `PrescriptionViewer`: Visualização e impressão

### 4.3 Estados da Interface
- **Busca**: Seleção de paciente
- **Lista**: Receitas do paciente selecionado
- **Nova**: Formulário de criação (sempre com múltiplas datas)
- **Visualizar**: Preview e impressão

## 5. MELHORIAS IMPLEMENTADAS

### 5.1 UX/UI
- ✅ Logo oficial integrado em todas as receitas
- ✅ Múltiplas receitas sempre acessíveis (não escondidas)
- ✅ Posologia opcional com fallback inteligente
- ✅ Instruções claras em cada seção
- ✅ Feedback visual adequado (toasts, estados)

### 5.2 Funcionalidades
- ✅ Geração automática de múltiplas receitas
- ✅ Template oficial completo para impressão
- ✅ Flexibilidade na prescrição (posologia opcional)
- ✅ Validações inteligentes (mínimo necessário)

### 5.3 Manutenibilidade
- ✅ Componentes pequenos e focados
- ✅ Separação clara de responsabilidades
- ✅ TypeScript para segurança de tipos
- ✅ Código documentado e padronizado

## 6. CHECKLIST DE VALIDAÇÃO FINAL

### 6.1 Receitas
- [x] Logo oficial aparece em tela e impressão
- [x] Cabeçalho completo com dados institucionais  
- [x] Layout otimizado para impressão A4
- [x] Dados do paciente e receita corretos

### 6.2 Múltiplas Receitas
- [x] Interface sempre visível (sem toggle)
- [x] Seleção por checkbox funcional
- [x] Adição/remoção de datas dinâmica
- [x] Contador de receitas selecionadas
- [x] Botão muda texto conforme seleção

### 6.3 Medicamentos
- [x] Posologia opcional na interface
- [x] Fallback automático para "Conforme orientação médica"
- [x] Adição de medicamento sem posologia funciona
- [x] Validação apenas do medicamento obrigatório

### 6.4 Sistema Geral
- [x] Todas as funcionalidades anteriores mantidas
- [x] Interface responsiva preservada
- [x] Performance adequada
- [x] Não há erros de console

## 7. DOCUMENTAÇÃO TÉCNICA

### 7.1 Arquivos Modificados
- `src/components/prescriptions/PrescriptionHeader.tsx`
- `src/components/PrescriptionDateSelector.tsx`
- `src/components/prescription-form/MedicineSelector.tsx`
- `plano_estrategico.txt`

### 7.2 Principais Mudanças
1. **Logo oficial**: Integração completa em tela e impressão
2. **Datas múltiplas**: Sempre visível, sem toggle, interface melhorada
3. **Posologia opcional**: Validação flexível com fallback inteligente
4. **UX**: Instruções claras, feedback visual, interface intuitiva

### 7.3 Compatibilidade
- ✅ Mantém compatibilidade com backend existente
- ✅ Preserva todas as funcionalidades anteriores
- ✅ Não quebra fluxos de trabalho existentes
- ✅ Layout responsivo mantido

## 8. CONCLUSÃO

O sistema foi atualizado com sucesso para atender aos requisitos solicitados:

1. **Cabeçalho oficial** com logo e dados institucionais completos
2. **Múltiplas receitas sempre visíveis** para melhor UX
3. **Posologia opcional** com fallback inteligente
4. **Interface aprimorada** com instruções e feedback

Todas as alterações foram implementadas mantendo a estabilidade e funcionalidade do sistema existente, com foco na melhoria da experiência do usuário e conformidade com padrões oficiais.

---
**Sistema SISMED Perobal - Versão 2.0**
**Última atualização: 15/08/2025**
